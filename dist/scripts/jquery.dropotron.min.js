(C=>{C.fn.disableSelection_dropotron=function(){return C(this).css("user-select","none").css("-khtml-user-select","none").css("-moz-user-select","none").css("-o-user-select","none").css("-webkit-user-select","none")},C.fn.dropotron=function(e){if(0==this.length)return C(this);if(1<this.length)for(var t=0;t<this.length;t++)C(this[t]).dropotron(e);return C.dropotron(C.extend({selectorParent:C(this)},e))},C.dropotron=function(e){var p=C.extend({selectorParent:null,baseZIndex:1e3,menuClass:"dropotron",expandMode:"hover",hoverDelay:150,hideDelay:250,openerClass:"opener",openerActiveClass:"active",submenuClassPrefix:"level-",mode:"fade",speed:"fast",easing:"swing",alignment:"left",offsetX:0,offsetY:0,globalOffsetY:0,IEOffsetX:0,IEOffsetY:0,noOpenerFade:!0,detach:!0,cloneOnDetach:!0},e),s=p.selectorParent,u=s.find("ul"),n=C("body"),e=C("body,html"),h=C(window),g=!1,t=null,v=null;s.on("doCollapseAll",function(){u.trigger("doCollapse")}),u.each(function(){var c=C(this),f=c.parent();0<p.hideDelay&&c.add(f).on("mouseleave",function(e){window.clearTimeout(v),v=window.setTimeout(function(){c.trigger("doCollapse")},p.hideDelay)}),c.disableSelection_dropotron().hide().addClass(p.menuClass).css("position","absolute").on("mouseenter",function(e){window.clearTimeout(v)}).on("doExpand",function(){if(!c.is(":visible")){window.clearTimeout(v),u.each(function(){var e=C(this);C.contains(e.get(0),f.get(0))||e.trigger("doCollapse")});var e,t,o,n=f.offset(),s=f.position(),i=(f.parent().position(),f.outerWidth()),l=c.outerWidth(),a=c.css("z-index")==p.baseZIndex;if(a){switch(o=(e=p.detach?n:s).top+f.outerHeight()+p.globalOffsetY,t=p.alignment,c.removeClass("left").removeClass("right").removeClass("center"),p.alignment){case"right":(d=e.left-l+i)<0&&(d=e.left,t="left");break;case"center":(d=e.left-Math.floor((l-i)/2))<0?(d=e.left,t="left"):d+l>h.width()&&(d=e.left-l+i,t="right");break;default:(d=e.left)+l>h.width()&&(d=e.left-l+i,t="right")}c.addClass(t)}else"right"===(d="relative"==f.css("position")||"absolute"==f.css("position")?(o=p.offsetY,-1*s.left):(o=s.top+p.offsetY,0),p.alignment)?d+=-1*f.parent().outerWidth()+p.offsetX:d+=f.parent().outerWidth()+p.offsetX;navigator.userAgent.match(/MSIE ([0-9]+)\./)&&RegExp.$1<8&&(d+=p.IEOffsetX,o+=p.IEOffsetY),c.css("left",d+"px").css("top",o+"px").css("opacity","0.01").show();var r=!1,d="relative"==f.css("position")||"absolute"==f.css("position")?-1*s.left:0;switch(c.offset().left<0?(d+=f.parent().outerWidth()-p.offsetX,r=!0):c.offset().left+l>h.width()&&(d+=-1*f.parent().outerWidth()-p.offsetX,r=!0),r&&c.css("left",d+"px"),c.hide().css("opacity","1"),p.mode){case"zoom":g=!0,f.addClass(p.openerActiveClass),c.animate({width:"toggle",height:"toggle"},p.speed,p.easing,function(){g=!1});break;case"slide":g=!0,f.addClass(p.openerActiveClass),c.animate({height:"toggle"},p.speed,p.easing,function(){g=!1});break;case"fade":g=!0,a&&!p.noOpenerFade?(r="slow"==p.speed?80:"fast"==p.speed?40:Math.floor(p.speed/2),f.fadeTo(r,.01,function(){f.addClass(p.openerActiveClass),f.fadeTo(p.speed,1),c.fadeIn(p.speed,function(){g=!1})})):(f.addClass(p.openerActiveClass),f.fadeTo(p.speed,1),c.fadeIn(p.speed,function(){g=!1}));break;default:f.addClass(p.openerActiveClass),c.show()}}return!1}).on("doCollapse",function(){return c.is(":visible")&&(c.hide(),f.removeClass(p.openerActiveClass),c.find("."+p.openerActiveClass).removeClass(p.openerActiveClass),c.find("ul").hide()),!1}).on("doToggle",function(e){return c.is(":visible")?c.trigger("doCollapse"):c.trigger("doExpand"),!1}),f.disableSelection_dropotron().addClass("opener").css("cursor","pointer").on("click touchend",function(e){g||(e.preventDefault(),e.stopPropagation(),c.trigger("doToggle"))}),"hover"==p.expandMode&&f.hover(function(e){g||(t=window.setTimeout(function(){c.trigger("doExpand")},p.hoverDelay))},function(e){window.clearTimeout(t)})}),u.find("a").css("display","block").on("click touchend",function(e){g||C(this).attr("href").length<1&&e.preventDefault()}),s.find("li").css("white-space","nowrap").each(function(){var e=C(this),t=e.children("a"),o=e.children("ul"),n=t.attr("href");t.on("click touchend",function(e){0==n.length||"#"==n?e.preventDefault():e.stopPropagation()}),0<t.length&&0==o.length&&e.on("click touchend",function(e){g||(s.trigger("doCollapseAll"),e.stopPropagation())})}),s.children("li").each(function(){var e=C(this).children("ul");if(0<e.length){p.detach&&(p.cloneOnDetach&&e.clone().attr("class","").hide().appendTo(e.parent()),e.detach().appendTo(n));for(var t=p.baseZIndex,o=e;0<o.length;0)o.css("z-index",t++),p.submenuClassPrefix&&o.addClass(p.submenuClassPrefix+(t-1-p.baseZIndex)),o=o.find("> li > ul")}}),h.on("scroll",function(){s.trigger("doCollapseAll")}).on("keypress",function(e){g||27!=e.keyCode||(e.preventDefault(),s.trigger("doCollapseAll"))}),e.on("click touchend",function(){g||s.trigger("doCollapseAll")})}})(jQuery);